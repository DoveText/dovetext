"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8269],{6564:function(e,t,s){s.d(t,{x:function(){return a}});var r=s(3107),n=s(9359);let a=r.Z.create({baseURL:"https://api.dovetext.com",headers:{"Content-Type":"application/json"}});a.interceptors.request.use(async e=>{console.log("[API Client] Request interceptor called for:",e.url);try{let t=n.auth.currentUser;if(!t)return console.error("[API Client] Not authenticated, rejecting request"),Promise.reject(Error("Not authenticated"));let s=await t.getIdToken();console.log("[API Client] Successfully obtained token for request"),e.headers.Authorization="Bearer ".concat(s),console.log("[API Client] Request headers set:",{contentType:e.headers["Content-Type"],hasAuth:!!e.headers.Authorization,method:e.method,url:e.url})}catch(e){return console.error("[API Client] Error getting Firebase token:",e),Promise.reject(e)}return e},e=>(console.error("[API Client] Request interceptor error:",e),Promise.reject(e))),a.interceptors.response.use(e=>(console.log("[API Client] Response received:",{status:e.status,url:e.config.url,data:e.data}),e),e=>{var t,s,r;if(console.error("[API Client] Response error:",{url:null===(t=e.config)||void 0===t?void 0:t.url,status:null===(s=e.response)||void 0===s?void 0:s.status,statusText:null===(r=e.response)||void 0===r?void 0:r.statusText,message:e.message}),e.response)switch(e.response.status){case 401:window.location.pathname.includes("/signin")||(window.location.href="/signin");break;case 403:console.error("Access forbidden");break;case 404:console.error("Resource not found");break;default:console.error("API error:",e.response.data)}return Promise.reject(e)})},336:function(e,t,s){s.d(t,{a:function(){return l}});var r=s(3827),n=s(4090),a=s(8829);let l=(0,n.forwardRef)((e,t)=>{var s,l;let{onSubmit:o,isSending:i,showInputForm:c,currentTask:d,lastInteractiveMessage:u}=e,[m,x]=(0,n.useState)(""),p=(0,n.useRef)(null);(0,n.useImperativeHandle)(t,()=>({focus:()=>{var e;null===(e=p.current)||void 0===e||e.focus()}}));let b=(null==d?void 0:d.complete)||(null==u?void 0:u.interactive)&&((null==u?void 0:null===(s=u.interactiveData)||void 0===s?void 0:s.function)==="form"&&!(null==u?void 0:u.isResponseSubmitted)||(null==u?void 0:null===(l=u.interactiveData)||void 0===l?void 0:l.function)==="confirm"&&!(null==u?void 0:u.isResponseSubmitted)),f=(()=>{if(!b)return null;if((null==u?void 0:u.interactive)&&!(null==u?void 0:u.isResponseSubmitted)){var e;let t=null===(e=u.interactiveData)||void 0===e?void 0:e.function;if("chat"===t)return"Please provide your answers or response according to above message";if("select"===t)return"Please select one option from above list or provided your custom answer";if("confirm"===t)return"Please confirm your selection by clicking one of above options";if("form"===t)return"Please provide information by completing above form"}return null})();return c?(0,r.jsx)("form",{onSubmit:e=>{if(e.preventDefault(),!m.trim()){setTimeout(()=>{var e;return null===(e=p.current)||void 0===e?void 0:e.focus()},0);return}x(""),setTimeout(()=>{var e;return null===(e=p.current)||void 0===e?void 0:e.focus()},0),o(m)},className:"flex items-center p-4 border-t bg-white chat-form mb-3 rounded-b-lg",children:(0,r.jsxs)("div",{className:"relative flex-1",children:[(0,r.jsx)("input",{ref:p,type:"text",value:m,onChange:e=>x(e.target.value),placeholder:(()=>{if(null==d?void 0:d.complete)return"Task completed!";if((null==u?void 0:u.interactive)&&(null==u?void 0:u.interactiveData)&&!(null==u?void 0:u.isResponseSubmitted))switch(u.interactiveData.function){case"chat":default:return"Type your response...";case"confirm":return"Select Yes or No, or type your response...";case"select":return"Choose an option or type your response...";case"form":return"Fill out the form..."}return d?"Continue your conversation...":"Ask me anything..."})(),disabled:b,className:"w-full p-2 pr-10 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 ".concat(b?"bg-gray-100 cursor-not-allowed":"")}),f&&(0,r.jsx)("div",{className:"absolute -top-6 left-0 right-0 text-sm text-red-500 bg-red-50 py-1 rounded",children:f}),(0,r.jsx)("button",{type:"submit",disabled:(null==d?void 0:d.complete)||i||b,className:"absolute right-2 top-1/2 transform -translate-y-1/2 p-2 rounded-full focus:outline-none ".concat((null==d?void 0:d.complete)||b?"text-gray-400":i?"text-blue-500":"text-blue-500 hover:bg-blue-100"),children:i?(0,r.jsxs)("svg",{className:"animate-spin h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):(0,r.jsx)(a.Z,{className:"h-6 w-6"})})]})}):null});l.displayName="ChatInputArea",t.Z=l},7666:function(e,t,s){let r;s.d(t,{$:function(){return p},Z:function(){return b}});var n=s(3827),a=s(4090),l=e=>{let{parameters:t,onResponse:s,isResponseSubmitted:r}=e,[l,o]=(0,a.useState)(null),{yesPrompt:i,noPrompt:c}=t;console.log("[ConfirmInteraction] Parameters:",t);let d=(e,t)=>{r||(o(t),s(e))};return(0,n.jsx)("div",{className:"mt-2 mb-4",children:(0,n.jsxs)("div",{className:"flex space-x-2",children:[(0,n.jsx)("button",{onClick:()=>d(!0,i),disabled:r,className:"px-4 py-2 rounded-md text-sm transition-colors ".concat(r?l===i?"bg-blue-500 text-white":"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-blue-100 text-blue-700 hover:bg-blue-200"),children:i}),(0,n.jsx)("button",{onClick:()=>d(!1,c),disabled:r,className:"px-4 py-2 rounded-md text-sm transition-colors ".concat(r?l===c?"bg-blue-500 text-white":"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:c})]})})},o=e=>{let{parameters:t,onResponse:s,isResponseSubmitted:r,message:l}=e,[o,i]=(0,a.useState)(null),[c,d]=(0,a.useState)(null),{question:u,options:m,placeholder:x}=t;(0,a.useEffect)(()=>{if(r&&(null==l?void 0:l.responseValue)){let e=String(l.responseValue);i(e),m.includes(e)||d(e)}},[r,l,m]);let p=e=>{r||(i(e),d(null),s(e))};return(0,n.jsxs)("div",{className:"mt-2 mb-4",children:[(0,n.jsx)("div",{className:"flex flex-wrap gap-2",children:m.map((e,t)=>(0,n.jsx)("button",{onClick:()=>p(e),disabled:r,className:"px-4 py-2 rounded-md text-sm transition-colors ".concat(r?o===e?"bg-blue-500 text-white":"bg-gray-200 text-gray-500 cursor-not-allowed":"bg-blue-100 text-blue-700 hover:bg-blue-200"),children:e},t))}),c&&r&&(0,n.jsxs)("div",{className:"mt-2 text-sm text-amber-600 bg-amber-50 p-2 rounded",children:["User provided custom option: ",(0,n.jsxs)("span",{className:"font-semibold",children:['"',c,'"']})]})]})},i=s(558),c=s(8005),d=e=>{let{parameters:t,onResponse:s,isResponseSubmitted:r,submittedValues:l}=e,[o,d]=(0,a.useState)(!1),[u,m]=(0,a.useState)({}),[x,p]=(0,a.useState)(!1),[b,f]=(0,a.useState)([]),h=(0,a.useRef)(null),g=()=>{let{prompt:e,description:s,submitText:r="Submit",cancelText:n="Cancel"}=t,a=[];return t.fields&&(Array.isArray(t.fields)?a=t.fields.map(e=>{if("string"==typeof e)try{let t=JSON.parse(e),s=t.name;return{name:s,label:t.label||s,type:t.type||"string",required:t.required||!1,options:t.options||[],placeholder:t.description||t.label||s,defaultValue:t.defaultValue}}catch(e){return console.error("Error parsing field:",e),null}return e}).filter(e=>null!==e):"object"==typeof t.fields&&console.log("Field arrays: ",a=Object.entries(t.fields).map(e=>{let[t,s]=e,r={};try{r="string"==typeof s?JSON.parse(s):s}catch(e){console.error("Error parsing field data for ".concat(t,":"),e)}return{name:t,label:r.label||t,type:r.type||"string",required:r.required||!1,options:r.options||[],placeholder:r.description||r.label||t,defaultValue:r.defaultValue}}))),{title:e||"Please fill out this form",description:s,fields:a,submitText:r,cancelText:n}},v=g();(0,a.useEffect)(()=>{let e=g();f(e.fields);let t={};e.fields.forEach(e=>{void 0!==e.defaultValue?t[e.name]=e.defaultValue:"checkbox"===e.type?t[e.name]=!1:t[e.name]=""}),m(t),r||d(!0)},[t,r]),(0,a.useEffect)(()=>{o&&h.current&&setTimeout(()=>{var e;null===(e=h.current)||void 0===e||e.scrollIntoView({behavior:"smooth",block:"center"})},100)},[o]);let y=(e,t)=>{m(s=>({...s,[e.name]:t}))},j=e=>{let{name:t,label:s,type:a,required:l,options:o,placeholder:i}=e;switch(a){case"string":case"email":case"number":case"password":return(0,n.jsxs)("div",{className:"mb-4 flex items-center space-x-4",children:[(0,n.jsxs)("label",{htmlFor:t,className:"text-sm font-medium text-gray-700 min-w-[120px]",children:[s,l&&(0,n.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,n.jsx)("input",{type:"string"===a?"text":a,id:t,name:t,value:u[t]||"",onChange:t=>y(e,t.target.value),placeholder:i,required:l,disabled:r,className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]},t);case"textarea":return(0,n.jsxs)("div",{className:"mb-4 flex items-start space-x-4",children:[(0,n.jsxs)("label",{htmlFor:t,className:"text-sm font-medium text-gray-700 min-w-[120px] pt-2",children:[s,l&&(0,n.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,n.jsx)("textarea",{id:t,name:t,value:u[t]||"",onChange:t=>y(e,t.target.value),placeholder:i,required:l,disabled:r,rows:4,className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]},t);case"select":return(0,n.jsxs)("div",{className:"mb-4 flex items-center space-x-4",children:[(0,n.jsxs)("label",{htmlFor:t,className:"text-sm font-medium text-gray-700 min-w-[120px]",children:[s,l&&(0,n.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,n.jsxs)("select",{id:t,name:t,value:u[t]||"",onChange:t=>y(e,t.target.value),required:l,disabled:r,className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,n.jsx)("option",{value:"",disabled:!0,children:i||"Select an option"}),null==o?void 0:o.map((e,t)=>(0,n.jsx)("option",{value:e,children:e},t))]})]},t);case"checkbox":return(0,n.jsxs)("div",{className:"mb-4 flex items-center space-x-4",children:[(0,n.jsx)("div",{className:"min-w-[120px]"}),(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("input",{type:"checkbox",id:t,name:t,checked:!!u[t],onChange:t=>y(e,t.target.checked),required:l,disabled:r,className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),(0,n.jsxs)("label",{htmlFor:t,className:"ml-2 text-sm text-gray-700",children:[s,l&&(0,n.jsx)("span",{className:"text-red-500",children:"*"})]})]})]},t);case"radio":return(0,n.jsxs)("div",{className:"mb-4 flex space-x-4",children:[(0,n.jsxs)("div",{className:"text-sm font-medium text-gray-700 min-w-[120px] pt-2",children:[s,l&&(0,n.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,n.jsx)("div",{className:"flex-1 space-y-2",children:null==o?void 0:o.map((s,a)=>(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("input",{id:"".concat(t,"-").concat(a),name:t,type:"radio",value:s,checked:u[t]===s,onChange:()=>y(e,s),required:l,disabled:r,className:"h-4 w-4 text-blue-600 border-gray-300 focus:ring-blue-500"}),(0,n.jsx)("label",{htmlFor:"".concat(t,"-").concat(a),className:"ml-2 text-sm text-gray-700",children:s})]},a))})]},t);default:return null}};return r?(0,n.jsxs)("div",{className:"mt-2 bg-gray-50 p-3 rounded-md border border-gray-200",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center cursor-pointer",onClick:()=>p(!x),children:[(0,n.jsxs)("span",{className:"font-medium text-gray-700",children:[x?"Hide":"Show"," Form Responses"]}),x?(0,n.jsx)(i.Z,{className:"h-5 w-5 text-gray-500"}):(0,n.jsx)(c.Z,{className:"h-5 w-5 text-gray-500"})]}),x&&(0,n.jsx)("div",{className:"mt-2 space-y-2",children:b.map(e=>(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsxs)("span",{className:"text-sm font-medium text-gray-600 mr-2",children:[e.label,":"]}),(0,n.jsx)("span",{className:"text-sm text-gray-800",children:"boolean"==typeof(null==l?void 0:l[e.name])?l[e.name]?"Yes":"No":(null==l?void 0:l[e.name])||"Not provided"})]},e.name))})]}):(0,n.jsx)("div",{className:"mt-2",children:o&&(0,n.jsx)("div",{className:"p-4",children:(0,n.jsxs)("form",{onSubmit:e=>{e.preventDefault(),s(u),d(!1)},className:"mt-4",children:[b.map(e=>j(e)),(0,n.jsxs)("div",{ref:h,className:"flex justify-end mt-4 space-x-2",children:[(0,n.jsx)("button",{type:"button",onClick:()=>{s({}),d(!1)},disabled:r,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 border border-gray-300 rounded-md hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-blue-500",children:v.cancelText}),(0,n.jsx)("button",{type:"submit",disabled:r,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:v.submitText})]})]})})})};try{r=s(7245)}catch(e){r=e=>{let{children:t}=e;return(0,n.jsx)("div",{className:"whitespace-pre-wrap",children:t})}}var u=e=>{let{parameters:t}=e,{title:s,content:a,format:l="text",level:o="info"}=t,i=(()=>{switch(o){case"error":return{container:"bg-red-50 border-red-100",title:"text-red-800",content:"text-red-700"};case"warn":case"warning":return{container:"bg-amber-50 border-amber-100",title:"text-amber-800",content:"text-amber-700"};case"success":return{container:"bg-green-50 border-green-100",title:"text-green-800",content:"text-green-700"};default:return{container:"bg-blue-50 border-blue-100",title:"text-blue-800",content:"text-blue-700"}}})();return(0,n.jsxs)("div",{className:"mt-2 mb-4 p-4 ".concat(i.container," border rounded-md"),children:[s&&(0,n.jsx)("div",{className:"font-medium ".concat(i.title," mb-2"),children:s}),(0,n.jsx)("div",{className:"text-sm ".concat(i.content),children:"markdown"===l?(0,n.jsx)(r,{className:"prose prose-sm max-w-none",children:a}):"html"===l?(0,n.jsx)("div",{dangerouslySetInnerHTML:{__html:a}}):(0,n.jsx)("div",{className:"whitespace-pre-wrap",children:a})})]})},m=e=>{let{message:t,onResponse:s,isResponseSubmitted:r,parentMessage:a}=e,{function:i,parameters:c}=t,m=null==a?void 0:a.responseValue;switch(i){case"confirm":return(0,n.jsx)(l,{parameters:c,onResponse:s,isResponseSubmitted:r});case"select":return(0,n.jsx)(o,{parameters:c,onResponse:s,isResponseSubmitted:r,message:a});case"form":return(0,n.jsx)(d,{parameters:c,onResponse:s,isResponseSubmitted:r,submittedValues:m});case"present":return(0,n.jsx)(u,{parameters:c});case"chat":return null;default:return console.warn("Unknown interactive function type: ".concat(i)),null}},x=s(7474);let p=e=>{let{chatHistory:t,isProcessing:s,processingHint:r,currentTask:l,getContextExample:o,onInteractiveResponse:i}=e,c=(0,a.useRef)(null),d=(0,a.useRef)(null),u=(0,a.useRef)(null);(0,a.useEffect)(()=>{if(s&&u.current){u.current.scrollIntoView({behavior:"smooth"});return}d.current?d.current.scrollIntoView({behavior:"smooth"}):c.current&&(c.current.scrollTop=c.current.scrollHeight)},[t,s]);let p=(e,t)=>{i&&i(e,t)};return(0,n.jsxs)("div",{ref:c,className:"flex-1 overflow-y-auto p-4 space-y-4 bg-gray-50",children:[0===t.length&&!s&&(0,n.jsxs)("div",{className:"text-center py-8",children:[(0,n.jsx)("h3",{className:"text-lg font-medium text-gray-700 mb-2",children:"How can I help you today?"}),(0,n.jsxs)("p",{className:"text-sm text-gray-500 mb-4",children:["Try asking me something like ",o()]})]}),t.map((e,s)=>{let r=s===t.length-1;return(0,n.jsxs)("div",{ref:r?d:void 0,className:"flex flex-col ".concat("user"===e.type?"items-end":"items-start"),children:[(0,n.jsx)("div",{className:"text-xs text-gray-400 mb-1 px-1",children:e.timestamp?"".concat("user"===e.type?"Sent":"Received"," at ").concat(new Date(e.timestamp).toLocaleString()):""}),(0,n.jsxs)("div",{className:"max-w-[85%] rounded-lg px-4 py-2 ".concat("user"===e.type?"bg-blue-500 text-white":"error"===e.type?"bg-red-100 text-red-800 border border-red-200":"bg-white text-gray-800 border border-gray-200"),children:[(0,n.jsx)("div",{children:e.content}),e.interactive&&e.interactiveData&&(0,n.jsx)(m,{message:e.interactiveData,onResponse:t=>{let r=e.id||"interactive-".concat(s,"-").concat(Date.now());console.log("[ChatMessageList] Handling interactive response for message ID:",r),e.responseValue=t,p(r,t)},isResponseSubmitted:!!e.isResponseSubmitted,parentMessage:e})]}),"user"===e.type&&e.interactive&&(0,n.jsxs)("div",{className:"flex items-center mt-1 space-x-1 text-xs text-gray-500 italic",children:[(0,n.jsx)(x.Z,{className:"h-3 w-3 text-blue-400"}),(0,n.jsxs)("span",{children:["form"===e.request&&"Response to form submission","select"===e.request&&"Response to selection prompt","confirm"===e.request&&"Response to confirmation prompt"]})]})]},e.id||"message-".concat(s))}),s&&(0,n.jsx)("div",{ref:u,className:"flex justify-start",children:(0,n.jsx)("div",{className:"bg-white text-gray-800 border border-gray-200 rounded-lg px-4 py-2 max-w-[85%]",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("span",{className:"text-sm",children:r}),(0,n.jsxs)("span",{className:"ml-2 flex space-x-1",children:[(0,n.jsx)("span",{className:"h-2 w-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),(0,n.jsx)("span",{className:"h-2 w-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),(0,n.jsx)("span",{className:"h-2 w-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})]})})}),l&&!l.complete&&(0,n.jsxs)("div",{className:"mt-4 bg-blue-50 border border-blue-100 rounded-lg p-3",children:[(0,n.jsxs)("div",{className:"text-sm text-blue-800 mb-1",children:["Task in progress: Step ",l.currentStep," of ",l.steps]}),(0,n.jsx)("div",{className:"w-full bg-blue-200 rounded-full h-2",children:(0,n.jsx)("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:"".concat(l.currentStep/l.steps*100,"%")}})})]})]})};var b=p},2393:function(e,t,s){s.d(t,{Q:function(){return o}});var r=s(3827);s(4090);var n=s(1530),a=s(834),l=s(5677);function o(e){let{connectionStatus:t,onReconnect:s}=e;return(0,r.jsxs)("div",{className:"bg-amber-100 connection-status flex items-center justify-between px-4 py-1 text-xs",children:[(0,r.jsx)("div",{className:"text-gray-700 font-medium",children:"You are talking with your personal DoveText AI Assistant"}),"connected"===t&&(0,r.jsxs)("div",{className:"flex items-center text-green-600",children:[(0,r.jsx)(n.Z,{className:"w-3 h-3 mr-1"}),(0,r.jsx)("span",{children:"Connected"})]}),"reconnecting"===t&&(0,r.jsxs)("div",{className:"flex items-center text-amber-600",children:[(0,r.jsx)(a.Z,{className:"w-3 h-3 mr-1 animate-spin"}),(0,r.jsx)("span",{children:"Reconnecting..."})]}),"disconnected"===t&&(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("div",{className:"text-red-600 flex items-center",children:[(0,r.jsx)(l.Z,{className:"w-3 h-3 mr-1"}),(0,r.jsx)("span",{children:"Disconnected"})]}),(0,r.jsxs)("button",{onClick:s,className:"text-blue-600 hover:text-blue-800 flex items-center",children:[(0,r.jsx)(a.Z,{className:"w-3 h-3 mr-1"}),(0,r.jsx)("span",{children:"Reconnect"})]})]})]})}}}]);