(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6054],{2175:function(e,t,a){Promise.resolve().then(a.bind(a,2610))},7907:function(e,t,a){"use strict";var s=a(5313);a.o(s,"useParams")&&a.d(t,{useParams:function(){return s.useParams}}),a.o(s,"usePathname")&&a.d(t,{usePathname:function(){return s.usePathname}}),a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}}),a.o(s,"useSearchParams")&&a.d(t,{useSearchParams:function(){return s.useSearchParams}})},2610:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return l}});var s=a(3827),n=a(4090),r=a(9359),i=a(7907);function l(){let{user:e,sendVerificationEmail:t,getIdToken:a,refreshUserStatus:l}=(0,r.useAuth)(),c=(0,i.useRouter)(),o=(0,i.useSearchParams)(),[u,d]=(0,n.useState)(0),[m,h]=(0,n.useState)(null),[f,x]=(0,n.useState)(null),[v,g]=(0,n.useState)(!1),[y,p]=(0,n.useState)(0),[b,j]=(0,n.useState)(!1),N=(0,n.useRef)(!1),w=(0,n.useCallback)(async()=>{if(!(u>0)&&e)try{h(null),x(null),await t();let e=await a();await fetch("/api/v1/auth/update-validation-sent",{method:"POST",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}}),x("Verification email sent! Please check your inbox."),d(60)}catch(e){console.error("Error sending verification email:",e),"auth/too-many-requests"===e.code?(h("Too many attempts. Please wait a few minutes before trying again."),d(300)):h("Failed to send verification email. Please try again later.")}},[u,e,t,a]);(0,n.useEffect)(()=>{"resend"!==(null==o?void 0:o.get("action"))||u||N.current||(N.current=!0,w())},[o,u,w]),(0,n.useEffect)(()=>{var t;(null==e?void 0:null===(t=e.settings)||void 0===t?void 0:t.validated)&&c.push("/dashboard"),e||c.push("/signin")},[e,c]),(0,n.useEffect)(()=>{let e;return u>0?e=setInterval(()=>{d(e=>e-1)},1e3):x(null),()=>clearInterval(e)},[u]),(0,n.useEffect)(()=>{let e;return y>0&&(e=setInterval(()=>{p(e=>e-1)},1e3)),()=>clearInterval(e)},[y]);let P=async()=>{if(!(y>0)&&e)try{var t;g(!0),h(null),x(null);let e=await l();(null==e?void 0:null===(t=e.settings)||void 0===t?void 0:t.validated)?c.push("/dashboard"):(h("Email is not verified yet. Please check your inbox and click the verification link."),p(5))}catch(e){console.error("Error refreshing status:",e),h("Failed to check verification status. Please try again."),p(5)}finally{g(!1)}};return e?(0,s.jsx)("div",{className:"min-h-screen bg-gray-100 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[(0,s.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Verify Your Email"}),(0,s.jsx)("div",{className:"mt-8 bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10",children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{children:(0,s.jsxs)("p",{className:"text-sm text-gray-500",children:["We sent a verification email to ",(0,s.jsx)("span",{className:"font-medium",children:e.email}),". Please check your inbox and click the verification link."]})}),m&&(0,s.jsx)("div",{className:"rounded-md bg-red-50 p-4",children:(0,s.jsx)("div",{className:"flex",children:(0,s.jsx)("div",{className:"ml-3",children:(0,s.jsx)("h3",{className:"text-sm font-medium text-red-800",children:m})})})}),f&&(0,s.jsx)("div",{className:"rounded-md bg-green-50 p-4",children:(0,s.jsx)("div",{className:"flex",children:(0,s.jsx)("div",{className:"ml-3",children:(0,s.jsx)("h3",{className:"text-sm font-medium text-green-800",children:f})})})}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("button",{onClick:w,disabled:u>0,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white \n                  ".concat(u>0?"bg-gray-400 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-700"),children:u>0?"Wait ".concat(u,"s to resend"):"Resend Verification Email"}),(0,s.jsx)("button",{onClick:P,disabled:y>0||v,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white \n                  ".concat(y>0||v?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700"),children:v?"Checking...":y>0?"Wait ".concat(y,"s to check again"):"I've Verified My Email"})]})]})})]})}):null}}},function(e){e.O(0,[9321,8593,9359,2971,8069,1744],function(){return e(e.s=2175)}),_N_E=e.O()}]);