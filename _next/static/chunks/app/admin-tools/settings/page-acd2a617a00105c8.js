(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9754],{5541:function(e,t,a){Promise.resolve().then(a.bind(a,1642))},1642:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return m}});var s=a(3827),r=a(4090),n=a(6564);let l={async getFunctions(){let{data:e}=await n.x.get("/api/v1/admin/settings/functions");return e},async getSettings(e){let{data:t}=await n.x.get("/api/v1/admin/settings/".concat(e));return t},async getSettingsByCategory(e){let{data:t}=await n.x.get("/api/v1/admin/settings/".concat(e,"/by-category"));return t},async getSetting(e,t){let{data:a}=await n.x.get("/api/v1/admin/settings/".concat(e,"/").concat(t));return a},async updateSetting(e,t,a){let{data:s}=await n.x.put("/api/v1/admin/settings/".concat(e,"/").concat(t),{value:a});return s},async resetSetting(e,t){let{data:a}=await n.x.delete("/api/v1/admin/settings/".concat(e,"/").concat(t));return a}};var i=a(8792),o=a(3536),c=a(9643),d=a(5548),u=a(2529);function m(){var e;let t={getFunctions:(0,r.useCallback)(l.getFunctions,[]),getSettings:(0,r.useCallback)(l.getSettings,[]),getSettingsByCategory:(0,r.useCallback)(l.getSettingsByCategory,[]),getSetting:(0,r.useCallback)(l.getSetting,[]),updateSetting:(0,r.useCallback)(l.updateSetting,[]),resetSetting:(0,r.useCallback)(l.resetSetting,[])},[a,n]=(0,r.useState)([]),[m,x]=(0,r.useState)(null),[g,h]=(0,r.useState)({}),[p,y]=(0,r.useState)(!0),[f,b]=(0,r.useState)(!1),[v,w]=(0,r.useState)(null),[j,N]=(0,r.useState)(null),[k,C]=(0,r.useState)(""),[S,E]=(0,r.useState)(null),[L,P]=(0,r.useState)({functionId:null,tabName:null}),B=(0,r.useRef)(null);(0,r.useEffect)(()=>{M()},[]),(0,r.useEffect)(()=>{m&&F(m)},[m]),(0,r.useEffect)(()=>{let e=Object.keys(g);e.length>0?m===L.functionId&&L.tabName&&e.includes(L.tabName)?E(L.tabName):E(e[0]):E(null)},[g,m,L]),(0,r.useEffect)(()=>{j&&B.current&&B.current.focus()},[j]);let I=e=>!!e&&!!e.sensitive,A=e=>e?"â€¢".repeat(Math.min(e.length,8)):"",R=e=>{var t;return(null===(t=e.allowedValues)||void 0===t?void 0:t.length)===2&&e.allowedValues.includes("true")&&e.allowedValues.includes("false")},V=e=>"true"===e.toLowerCase(),M=async()=>{try{y(!0),w(null);let e=await t.getFunctions();n(e),e.length>0&&x(e[0].id)}catch(e){w("Failed to load functions. Please try again."),console.error(e)}finally{y(!1)}},F=async e=>{try{y(!0),w(null);let a=await t.getSettingsByCategory(e);h(a)}catch(e){w("Failed to load settings. Please try again."),console.error(e)}finally{y(!1)}},Z=e=>{m&&S&&P({functionId:m,tabName:S}),x(e),N(null)},O=e=>{E(e),P({functionId:m,tabName:e})},T=e=>{N(e.key),C(e.value)},q=()=>{N(null)},_=(e,t)=>{"Enter"===e.key?W(t):"Escape"===e.key&&q()},W=async e=>{if(m&&S)try{b(!0),w(null);let a={...g};a[S]&&(a[S]=a[S].map(t=>t.key===e.key?{...t,value:k}:t),h(a)),N(null),P({functionId:m,tabName:S}),await t.updateSetting(m,e.key,k);let s=await t.getSettingsByCategory(m);h(s)}catch(e){w("Failed to update setting. Please try again."),console.error(e),m&&await F(m)}finally{b(!1)}},z=async e=>{if(m&&S)try{b(!0),w(null);let a={...g};a[S]&&(a[S]=a[S].map(t=>t.key===e.key?{...t,value:t.defaultValue}:t),h(a)),P({functionId:m,tabName:S}),await t.resetSetting(m,e.key);let s=await t.getSettingsByCategory(m);h(s)}catch(e){w("Failed to reset setting. Please try again."),console.error(e),m&&await F(m)}finally{b(!1)}};return(0,s.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,s.jsx)("nav",{className:"flex mb-6","aria-label":"Breadcrumb",children:(0,s.jsxs)("ol",{className:"inline-flex items-center space-x-1 md:space-x-3",children:[(0,s.jsx)("li",{className:"inline-flex items-center",children:(0,s.jsxs)(i.default,{href:"/admin-tools",className:"inline-flex items-center text-sm font-medium text-gray-700 hover:text-blue-600",children:[(0,s.jsx)(o.Z,{className:"w-4 h-4 mr-2"}),"Admin Tools"]})}),(0,s.jsx)("li",{children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(c.Z,{className:"w-4 h-4 text-gray-400"}),(0,s.jsx)("span",{className:"ml-1 text-sm font-medium text-gray-500 md:ml-2",children:"Settings Management"})]})})]})}),(0,s.jsx)("div",{className:"flex justify-between items-center mb-6",children:(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"Settings Management"})}),v&&(0,s.jsx)("div",{className:"bg-red-100 border-l-4 border-red-500 text-red-700 p-4 rounded-md mb-6",children:(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:(0,s.jsx)("svg",{className:"h-5 w-5 text-red-500",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),(0,s.jsx)("div",{className:"ml-3",children:(0,s.jsx)("p",{className:"text-sm",children:v})})]})}),(0,s.jsxs)("div",{className:"flex flex-col lg:flex-row gap-6",children:[(0,s.jsx)("div",{className:"lg:w-1/4",children:(0,s.jsxs)("div",{className:"bg-white shadow-md rounded-lg overflow-hidden",children:[(0,s.jsx)("div",{className:"bg-gray-50 px-4 py-3 border-b border-gray-200",children:(0,s.jsx)("h2",{className:"text-lg font-medium text-gray-800",children:"Functions"})}),p&&0===a.length?(0,s.jsx)("div",{className:"p-4 text-center",children:(0,s.jsx)("div",{className:"animate-pulse flex justify-center",children:(0,s.jsx)("div",{className:"h-4 w-28 bg-gray-200 rounded"})})}):(0,s.jsx)("ul",{className:"divide-y divide-gray-200",children:a.map(e=>(0,s.jsx)("li",{className:"py-3 px-4 cursor-pointer transition-colors duration-150 ".concat(m===e.id?"bg-blue-50 border-l-4 border-blue-500":"hover:bg-gray-50 border-l-4 border-transparent"),onClick:()=>Z(e.id),children:(0,s.jsx)("div",{className:"font-medium text-gray-900",children:e.name})},e.id))})]})}),(0,s.jsx)("div",{className:"lg:w-3/4",children:m?(0,s.jsxs)("div",{className:"bg-white shadow-md rounded-lg overflow-hidden",children:[(0,s.jsx)("div",{className:"bg-gray-50 px-6 py-4 border-b border-gray-200",children:(0,s.jsxs)("h2",{className:"text-lg font-medium text-gray-800",children:[null===(e=a.find(e=>e.id===m))||void 0===e?void 0:e.name," Settings"]})}),p?(0,s.jsx)("div",{className:"p-6",children:(0,s.jsxs)("div",{className:"animate-pulse space-y-4",children:[(0,s.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/4"}),(0,s.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/2"}),(0,s.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4"})]})}):0===Object.keys(g).length?(0,s.jsx)("div",{className:"p-6 text-center text-gray-500",children:"No settings found for this function."}):(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"border-b border-gray-200",children:(0,s.jsx)("nav",{className:"flex overflow-x-auto","aria-label":"Tabs",children:Object.keys(g).map(e=>(0,s.jsx)("button",{onClick:()=>O(e),className:"\n                            whitespace-nowrap py-4 px-6 border-b-2 font-medium text-sm\n                            ".concat(S===e?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300","\n                          "),"aria-current":S===e?"page":void 0,children:e},e))})}),(0,s.jsx)("div",{className:"p-6",children:S&&g[S]&&(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,s.jsx)("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-1/3",children:"Setting"}),(0,s.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-1/2",children:"Value"}),(0,s.jsx)("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider w-1/6",children:"Actions"})]})}),(0,s.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:g[S].map(e=>(0,s.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,s.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,s.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name}),(0,s.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:e.description})]}),(0,s.jsx)("td",{className:"px-6 py-4",children:j===e.key?R(e)?(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("button",{type:"button",onClick:()=>C("true"),className:"px-3 py-2 text-sm font-medium rounded-l-md ".concat("true"===k?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:"Enabled"}),(0,s.jsx)("button",{type:"button",onClick:()=>C("false"),className:"px-3 py-2 text-sm font-medium rounded-r-md ".concat("false"===k?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:"Disabled"})]}):e.allowedValues?(0,s.jsx)("select",{value:k,onChange:e=>C(e.target.value),className:"block w-full px-3 py-2 rounded-md border border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm bg-white",disabled:f,onKeyDown:t=>_(t,e),onBlur:()=>W(e),children:e.allowedValues.map(e=>(0,s.jsx)("option",{value:e,children:e},e))}):(0,s.jsx)("input",{ref:B,type:I(e)?"password":"text",value:k,onChange:e=>C(e.target.value),className:"block w-full px-3 py-2 rounded-md border border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",disabled:f,onKeyDown:t=>_(t,e),onBlur:()=>W(e),placeholder:e.defaultValue||"(empty)",autoComplete:I(e)?"new-password":"off"}):(0,s.jsx)("div",{className:"text-sm text-gray-900",children:e.value?I(e)?(0,s.jsx)("span",{className:"text-gray-700",children:A(e.value)}):R(e)?(0,s.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(V(e.value)?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:V(e.value)?"Enabled":"Disabled"}):e.value:(0,s.jsx)("span",{className:"text-gray-400 italic",children:I(e)?"(secured)":e.defaultValue||"(empty)"})})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:j===e.key?(0,s.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,s.jsx)("button",{onClick:q,className:"text-gray-600 hover:text-gray-800",disabled:f,children:"Cancel"}),(0,s.jsx)("button",{onClick:()=>W(e),className:"text-blue-600 hover:text-blue-800",disabled:f,children:f?"Saving...":"Save"})]}):(0,s.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,s.jsx)("button",{onClick:()=>T(e),disabled:f,className:"text-blue-600 hover:text-blue-800 ".concat(f?"opacity-50 cursor-not-allowed":""),title:"Edit",children:(0,s.jsx)(d.Z,{className:"h-4 w-4"})}),(0,s.jsx)("button",{onClick:()=>z(e),disabled:f||e.value===e.defaultValue,className:"text-gray-600 hover:text-gray-800 ".concat(f||e.value===e.defaultValue?"opacity-50 cursor-not-allowed":""),title:"Reset to default",children:(0,s.jsx)(u.Z,{className:"h-4 w-4"})})]})})]},e.key))})]})})})]})]}):(0,s.jsxs)("div",{className:"bg-white shadow-md rounded-lg p-6 text-center text-gray-500",children:[(0,s.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),(0,s.jsx)("p",{className:"mt-2",children:"Select a function to view its settings."})]})})]})]})}},6564:function(e,t,a){"use strict";a.d(t,{x:function(){return n}});var s=a(3107),r=a(9359);let n=s.Z.create({baseURL:"https://api.dovetext.com",headers:{"Content-Type":"application/json"}});n.interceptors.request.use(async e=>{console.log("[API Client] Request interceptor called for:",e.url);try{let t=r.auth.currentUser;if(!t)return console.error("[API Client] Not authenticated, rejecting request"),Promise.reject(Error("Not authenticated"));let a=await t.getIdToken();console.log("[API Client] Successfully obtained token for request"),e.headers.Authorization="Bearer ".concat(a),console.log("[API Client] Request headers set:",{contentType:e.headers["Content-Type"],hasAuth:!!e.headers.Authorization,method:e.method,url:e.url})}catch(e){return console.error("[API Client] Error getting Firebase token:",e),Promise.reject(e)}return e},e=>(console.error("[API Client] Request interceptor error:",e),Promise.reject(e))),n.interceptors.response.use(e=>(console.log("[API Client] Response received:",{status:e.status,url:e.config.url,data:e.data}),e),e=>{var t,a,s;if(console.error("[API Client] Response error:",{url:null===(t=e.config)||void 0===t?void 0:t.url,status:null===(a=e.response)||void 0===a?void 0:a.status,statusText:null===(s=e.response)||void 0===s?void 0:s.statusText,message:e.message}),e.response)switch(e.response.status){case 401:window.location.pathname.includes("/signin")||(window.location.href="/signin");break;case 403:console.error("Access forbidden");break;case 404:console.error("Resource not found");break;default:console.error("API error:",e.response.data)}return Promise.reject(e)})},2529:function(e,t,a){"use strict";var s=a(4090);let r=s.forwardRef(function(e,t){let{title:a,titleId:r,...n}=e;return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},n),a?s.createElement("title",{id:r},a):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"}))});t.Z=r},9643:function(e,t,a){"use strict";var s=a(4090);let r=s.forwardRef(function(e,t){let{title:a,titleId:r,...n}=e;return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},n),a?s.createElement("title",{id:r},a):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m8.25 4.5 7.5 7.5-7.5 7.5"}))});t.Z=r},3536:function(e,t,a){"use strict";var s=a(4090);let r=s.forwardRef(function(e,t){let{title:a,titleId:r,...n}=e;return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},n),a?s.createElement("title",{id:r},a):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m2.25 12 8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25"}))});t.Z=r},5548:function(e,t,a){"use strict";var s=a(4090);let r=s.forwardRef(function(e,t){let{title:a,titleId:r,...n}=e;return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},n),a?s.createElement("title",{id:r},a):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"}))});t.Z=r}},function(e){e.O(0,[9321,8593,8792,3107,9359,2971,8069,1744],function(){return e(e.s=5541)}),_N_E=e.O()}]);