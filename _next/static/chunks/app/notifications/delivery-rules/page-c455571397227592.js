(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7321],{6784:function(e,t,s){Promise.resolve().then(s.bind(s,293))},1818:function(e,t,s){"use strict";s.d(t,{Z:function(){return i}});var a=s(6564);let i={getAll:async()=>(await a.x.get("/api/v1/chains")).data,get:async e=>(await a.x.get("/api/v1/chains/".concat(e))).data,create:async e=>(await a.x.post("/api/v1/chains",e)).data,update:async(e,t)=>(await a.x.put("/api/v1/chains/".concat(e),t)).data,async delete(e){await a.x.delete("/api/v1/chains/".concat(e))},toggleEnabled:async e=>(await a.x.post("/api/v1/chains/".concat(e,"/toggle"))).data}},293:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return E}});var a=s(3827),i=s(4090),n=s(1067),l=s(5548),r=s(4424),c=s(1310),d=s(6564);let o={getAll:async()=>(await d.x.get("/api/v1/rules")).data,get:async e=>(await d.x.get("/api/v1/rules/".concat(e))).data,create:async e=>(await d.x.post("/api/v1/rules",e)).data,update:async(e,t)=>(await d.x.put("/api/v1/rules/".concat(e),t)).data,delete:async e=>{await d.x.delete("/api/v1/rules/".concat(e))},enable:async e=>(await d.x.post("/api/v1/rules/".concat(e,"/enable"))).data,disable:async e=>(await d.x.post("/api/v1/rules/".concat(e,"/disable"))).data};var m=s(7490),x=s(129),u=s(6170),h=s(8621),g=s(1062),v=s(4895),p=s(3652),y=s(5507),f=s(1818),j=s(7474);function b(e){let t,{chain:s,onRemove:l,onClick:c,className:d="",isButton:o=!1}=e,m=(t="",s.description&&(t=s.description),t||"No description"),[x,u]=(0,i.useState)(!1),h=o?"text-sm text-gray-500":"text-xs text-gray-500";return(0,a.jsxs)(o?"button":"div",{onClick:c,className:"flex items-start space-x-3 bg-white rounded-lg border border-gray-200 ".concat(o?"w-full text-left hover:bg-gray-50":""," ").concat(o?"p-4 hover:bg-gray-50":"p-2"," ").concat(d),...o?{type:"button"}:{},children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)(n.Z,{className:"".concat(o?"h-6 w-6":"h-5 w-5"," text-gray-400"),"aria-hidden":"true"})}),(0,a.jsx)("div",{className:"min-w-0 flex-1",children:(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsxs)("div",{className:"flex items-baseline",children:[(0,a.jsx)("span",{className:"".concat(o?"text-base":"text-sm"," font-medium text-gray-900"),children:s.name}),s.stages&&s.stages.length>0&&(0,a.jsxs)("span",{className:"".concat(h," ml-1"),children:["(A chain with ",s.stages.length," stage",1!==s.stages.length?"s":"",")"]})]}),m?(0,a.jsxs)("div",{className:"relative mt-0.5",onMouseEnter:()=>u(!0),onMouseLeave:()=>u(!1),children:[(0,a.jsx)("p",{className:"".concat(h," truncate max-w-[300px]"),children:m}),x&&m.length>50&&(0,a.jsx)("div",{className:"absolute z-10 px-2 py-1 text-sm text-white bg-gray-900 rounded shadow-lg -mt-1 transform -translate-y-full max-w-xs",children:m})]}):(0,a.jsxs)("div",{className:"flex items-center mt-0.5 text-gray-400",children:[(0,a.jsx)(j.Z,{className:"h-4 w-4 mr-1"}),(0,a.jsx)("span",{className:"".concat(h," italic"),children:"No description available"})]})]})}),l&&(0,a.jsx)("button",{type:"button",onClick:e=>{e.stopPropagation(),l()},className:"flex-shrink-0 p-1 text-gray-400 hover:text-gray-500",children:(0,a.jsx)(r.Z,{className:"h-4 w-4"})})]})}let N=(0,i.forwardRef)(function(e,t){let{value:s=[],onChange:n,className:l="",hideAddButton:r=!1}=e,[d,o]=(0,i.useState)([]),[m,g]=(0,i.useState)(!1),[v,p]=(0,i.useState)(null),y=()=>g(!0);(0,i.useImperativeHandle)(t,()=>({openDialog:y}),[]),(0,i.useEffect)(()=>{(async()=>{try{let e=await f.Z.getAll();o(e),p(null)}catch(e){console.error("Failed to fetch escalation chains:",e),p("Failed to load escalation chains")}})()},[]);let N=e=>{let t=d.find(t=>t.id===e);t&&(n([...s,t]),g(!1))},w=e=>{n(s.filter(t=>t.id!==e))},C=d.filter(e=>!s.some(t=>t.id===e.id));return(0,a.jsxs)("div",{className:l,children:[(0,a.jsx)("div",{className:"space-y-2",children:s.length>0?s.map(e=>(0,a.jsx)(b,{chain:e,onRemove:()=>e.id&&w(e.id)},e.id)):(0,a.jsx)("div",{className:"rounded-lg border border-dashed border-gray-300 p-4",children:(0,a.jsx)("p",{className:"text-sm text-gray-500 text-center text-italic",children:"No escalation chain is selected"})})}),!r&&(0,a.jsxs)("button",{type:"button",onClick:y,className:"mt-2 inline-flex items-center text-sm text-indigo-600 hover:text-indigo-500",children:[(0,a.jsx)(c.Z,{className:"h-4 w-4 mr-1"}),"Add Chain"]}),(0,a.jsx)(x.u,{appear:!0,show:m,as:i.Fragment,children:(0,a.jsxs)(u.V,{as:"div",className:"relative z-10",onClose:()=>g(!1),children:[(0,a.jsx)(x.u.Child,{as:i.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-25"})}),(0,a.jsx)("div",{className:"fixed inset-0 overflow-y-auto",children:(0,a.jsx)("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:(0,a.jsx)(x.u.Child,{as:i.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,a.jsxs)(u.V.Panel,{className:"w-full max-w-md transform overflow-hidden rounded-2xl bg-white p-6 text-left align-middle shadow-xl transition-all",children:[(0,a.jsxs)(u.V.Title,{as:"h3",className:"text-lg font-medium leading-6 text-gray-900 flex justify-between items-center",children:["Select Escalation Chain",(0,a.jsx)("button",{type:"button",className:"rounded-md text-gray-400 hover:text-gray-500",onClick:()=>g(!1),children:(0,a.jsx)(h.Z,{className:"h-6 w-6"})})]}),v&&(0,a.jsx)("div",{className:"mt-2 rounded-md bg-red-50 p-4",children:(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)(j.Z,{className:"h-5 w-5 text-red-400"})}),(0,a.jsx)("div",{className:"ml-3",children:(0,a.jsx)("h3",{className:"text-sm font-medium text-red-800",children:v})})]})}),(0,a.jsxs)("div",{className:"mt-4 space-y-2",children:[C.map(e=>(0,a.jsx)(b,{chain:e,onClick:()=>{e.id&&N(e.id)},isButton:!0},e.id)),0===C.length&&(0,a.jsx)("p",{className:"text-sm text-gray-500 text-center py-4",children:"No available escalation chains"})]})]})})})})]})})]})});N.displayName="EscalationChainSelector";var w=s(1352),C=s(5183),S=s(1581),k=s(4849);let F=[{value:"1",label:"Low"},{value:"2",label:"Medium"},{value:"3",label:"High"},{value:"4",label:"Critical"},{value:"10",label:"Default"}];function T(e){let{isOpen:t,onClose:s,editingRule:n,onSave:l}=e,[r,d]=(0,i.useState)((null==n?void 0:n.name)||""),[m,j]=(0,i.useState)((null==n?void 0:n.description)||""),[b,T]=(0,i.useState)((null==n?void 0:n.priority)||10),[Z,A]=(0,i.useState)((null==n?void 0:n.timeslot)||{startTime:"09:00",endTime:"17:00",daysOfWeek:C.DD,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone}),[D,E]=(0,i.useState)((null==n?void 0:n.methodIds)||[]),[I,R]=(0,i.useState)((null==n?void 0:n.channelIds)||[]),[O,W]=(0,i.useState)((null==n?void 0:n.chainIds)||[]),[z,P]=(0,i.useState)([]),[_,V]=(0,i.useState)([]),[M,B]=(0,i.useState)([]),[q,H]=(0,i.useState)((null==n?void 0:n.conditions)||{}),[L,U]=(0,i.useState)((null==n?void 0:n.settings)||{isActive:!0}),[G,J]=(0,i.useState)({}),[K,Q]=(0,i.useState)(!1),X=(0,i.useRef)(null),Y=(0,i.useRef)(null),$=(0,i.useRef)(null);(0,i.useEffect)(()=>{n?(d(n.name),j(n.description||""),T(n.priority||10),A(n.timeslot||{startTime:"09:00",endTime:"17:00",daysOfWeek:C.DD,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone}),E(n.methodIds||[]),R(n.channelIds||[]),W(n.chainIds||[]),H(n.conditions||{}),U(n.settings||{isActive:!0})):(d(""),j(""),T(10),A({startTime:"09:00",endTime:"17:00",daysOfWeek:C.DD,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone}),E([]),R([]),W([]),H({}),U({isActive:!0})),J({})},[n]),(0,i.useEffect)(()=>{(async()=>{try{let[e,t,s]=await Promise.all([S.x.getAll(),k.q.getAll(),f.Z.getAll()]);P(e),V(t),B(s)}catch(e){console.error("Failed to fetch data:",e)}})()},[]);let ee=async e=>{e.preventDefault(),J({});let t={};if(r.trim()||(t.name="Name is required"),0===D.length&&0===I.length&&0===O.length&&(t.delivery="At least one delivery method, channel, or escalation chain must be selected"),Object.keys(t).length>0){J(t);return}try{Q(!0);let e={name:r,description:m||"",priority:b,methodIds:D.filter(e=>void 0!==e),channelIds:I.filter(e=>void 0!==e),chainIds:O.filter(e=>void 0!==e),timeslot:{startTime:Z.startTime||"00:00",endTime:Z.endTime||"23:59",daysOfWeek:Z.daysOfWeek,timezone:Z.timezone},conditions:{},settings:{isActive:!0}};n?await o.update(n.id,e):await o.create(e),l(),s()}catch(e){console.error("Failed to save rule:",e),J({submit:"Failed to save rule. Please try again."})}finally{Q(!1)}};return(0,a.jsx)(x.u,{appear:!0,show:t,as:i.Fragment,children:(0,a.jsxs)(u.V,{as:"div",className:"relative z-10",onClose:s,children:[(0,a.jsx)(x.u.Child,{as:i.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-25"})}),(0,a.jsx)("div",{className:"fixed inset-0 overflow-y-auto",children:(0,a.jsx)("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:(0,a.jsx)(x.u.Child,{as:i.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:(0,a.jsx)(u.V.Panel,{className:"w-full max-w-2xl transform overflow-hidden rounded-2xl bg-white p-6 text-left align-middle shadow-xl transition-all",children:(0,a.jsxs)("form",{onSubmit:ee,children:[(0,a.jsxs)(u.V.Title,{as:"h3",className:"text-lg font-medium leading-6 text-gray-900 flex justify-between items-center",children:[n?"Edit Delivery Rule":"New Delivery Rule",(0,a.jsx)("button",{type:"button",className:"rounded-md text-gray-400 hover:text-gray-500",onClick:s,children:(0,a.jsx)(h.Z,{className:"h-6 w-6"})})]}),G.submit&&(0,a.jsx)("div",{className:"mt-2 rounded-md bg-red-50 p-4",children:(0,a.jsx)("div",{className:"flex",children:(0,a.jsx)("div",{className:"ml-3",children:(0,a.jsx)("h3",{className:"text-sm font-medium text-red-800",children:G.submit})})})}),(0,a.jsxs)("div",{className:"mt-4 space-y-4",children:[(0,a.jsx)(v.Wi,{label:"Name",htmlFor:"name",error:G.name,children:(0,a.jsx)(v.yt,{id:"name",type:"text",value:r,onChange:e=>d(e.target.value),placeholder:"Enter rule name",error:G.name})}),(0,a.jsx)(v.Wi,{label:"Settings",htmlFor:"settings",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(w.Z,{value:Z,onChange:A}),(0,a.jsx)(v.Wi,{label:"Priority",children:(0,a.jsx)(g.Z,{value:b.toString(),onChange:e=>T(parseInt(e)),options:F})}),(0,a.jsx)("div",{children:(0,a.jsx)(v.Wi,{label:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{children:"Methods"}),(0,a.jsxs)("button",{type:"button",onClick:()=>{var e;return null===(e=X.current)||void 0===e?void 0:e.openDialog()},className:"inline-flex items-center text-sm text-indigo-600 hover:text-indigo-500",children:[(0,a.jsx)(c.Z,{className:"h-4 w-4 mr-1"}),"Add Method"]})]}),error:G.delivery,children:(0,a.jsx)(p.Z,{ref:X,value:z.filter(e=>D.includes(e.id)),onChange:e=>E(e.map(e=>e.id)),hideAddButton:!0})})}),(0,a.jsx)("div",{children:(0,a.jsx)(v.Wi,{label:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{children:"Channels"}),(0,a.jsxs)("button",{type:"button",onClick:()=>{var e;return null===(e=Y.current)||void 0===e?void 0:e.openDialog()},className:"inline-flex items-center text-sm text-indigo-600 hover:text-indigo-500",children:[(0,a.jsx)(c.Z,{className:"h-4 w-4 mr-1"}),"Add Channel"]})]}),error:G.delivery,children:(0,a.jsx)(y.Z,{ref:Y,value:_.filter(e=>I.includes(String(e.id))),onChange:e=>R(e.map(e=>String(e.id))),hideAddButton:!0})})}),(0,a.jsx)("div",{children:(0,a.jsx)(v.Wi,{label:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{children:"Escalation Chains"}),(0,a.jsxs)("button",{type:"button",onClick:()=>{var e;return null===(e=$.current)||void 0===e?void 0:e.openDialog()},className:"inline-flex items-center text-sm text-indigo-600 hover:text-indigo-500",children:[(0,a.jsx)(c.Z,{className:"h-4 w-4 mr-1"}),"Add Chain"]})]}),error:G.delivery,children:(0,a.jsx)(N,{ref:$,value:M.filter(e=>O.includes(String(e.id))),onChange:e=>W(e.map(e=>String(e.id))),hideAddButton:!0})})})]})}),(0,a.jsx)(v.Wi,{label:"Description",htmlFor:"description",children:(0,a.jsx)(v.ld,{id:"description",value:m,onChange:e=>j(e.target.value),placeholder:"Enter rule description",rows:3})}),(0,a.jsxs)("div",{className:"mt-6 flex justify-end space-x-3",children:[(0,a.jsx)("button",{type:"button",onClick:s,className:"rounded-md bg-white px-3 py-2 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",className:"rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600",children:n?"Save Changes":"Create Rule"})]})]})]})})})})})]})})}function Z(e){let{rules:t,onUpdate:s}=e,[d,x]=(0,i.useState)(null),[u,h]=(0,i.useState)(!1),[g,v]=(0,i.useState)(null),[p,y]=(0,i.useState)(null),[f,j]=(0,i.useState)(null),b=e=>{y(e)},N=async()=>{if(p)try{await o.delete(p.id),s(),y(null)}catch(e){j("Failed to delete delivery rule"),console.error(e)}},w=async e=>{try{e.settings.isActive?await o.disable(e.id):await o.enable(e.id),s()}catch(e){j("Failed to toggle rule status"),console.error(e)}},C=e=>{v(e),h(!0)};return(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"mt-4 space-y-2",children:t.map(e=>(0,a.jsx)("div",{className:"bg-white border rounded-lg shadow-sm hover:shadow transition-all duration-200",children:(0,a.jsxs)("div",{className:"relative flex justify-between gap-x-6 py-5 px-4",children:[(0,a.jsxs)("div",{className:"flex min-w-0 gap-x-4",children:[(0,a.jsx)("div",{className:"h-12 w-12 flex items-center justify-center rounded-lg bg-gray-50",children:(0,a.jsx)(n.Z,{className:"h-6 w-6 text-gray-600","aria-hidden":"true"})}),(0,a.jsxs)("div",{className:"min-w-0 flex-auto",children:[(0,a.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,a.jsx)("p",{className:"text-sm font-semibold leading-6 text-gray-900",children:e.name}),(0,a.jsx)("button",{onClick:()=>w(e),className:"inline-flex items-center rounded-md px-2 py-1 text-xs font-medium ".concat(e.settings.isActive?"bg-green-50 text-green-700 ring-1 ring-inset ring-green-600/20":"bg-gray-50 text-gray-600 ring-1 ring-inset ring-gray-500/10"),children:e.settings.isActive?"Active":"Inactive"}),e.settings.priority&&(0,a.jsxs)("span",{className:"inline-flex items-center rounded-md bg-blue-50 px-2 py-1 text-xs font-medium text-blue-700 ring-1 ring-inset ring-blue-600/20",children:["Priority ",e.settings.priority]})]}),e.description&&(0,a.jsx)("p",{className:"mt-1 text-sm leading-5 text-gray-500",children:e.description}),e.slots&&e.slots.length>0&&(0,a.jsx)("div",{className:"mt-2 flex flex-wrap gap-2",children:e.slots.map((e,t)=>(0,a.jsx)("span",{className:"inline-flex items-center rounded-md bg-gray-50 px-2 py-1 text-xs font-medium text-gray-600 ring-1 ring-inset ring-gray-500/10",children:e.name},t))})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-x-4",children:[(0,a.jsx)("button",{type:"button",onClick:()=>C(e),className:"rounded-md bg-white p-2 text-gray-400 hover:text-gray-500",children:(0,a.jsx)(l.Z,{className:"h-5 w-5"})}),(0,a.jsx)("button",{type:"button",onClick:()=>b(e),className:"rounded-md bg-white p-2 text-gray-400 hover:text-red-500",children:(0,a.jsx)(r.Z,{className:"h-5 w-5"})})]})]})},e.id))}),(0,a.jsxs)("button",{type:"button",onClick:()=>{v(null),h(!0)},className:"mt-4 inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",children:[(0,a.jsx)(c.Z,{className:"h-5 w-5 mr-2"}),"Add Rule"]}),(0,a.jsx)(T,{isOpen:u,onClose:()=>{h(!1),v(null)},onSave:()=>{h(!1),v(null),s()},editingRule:g}),(0,a.jsx)(m.Z,{isOpen:!!p,onClose:()=>y(null),onConfirm:N,title:"Delete Rule",message:"Are you sure you want to delete this rule? This action cannot be undone.",confirmText:"Delete",cancelText:"Cancel",confirmButtonClassName:"bg-red-600 text-white hover:bg-red-700 focus-visible:ring-red-500"})]})}var A=s(9359),D=s(2888);function E(){let[e,t]=(0,i.useState)([]),[s,n]=(0,i.useState)(!0),[l,r]=(0,i.useState)(null),{auth:c,onAuthStateChanged:d}=(0,A.useAuth)();(0,i.useEffect)(()=>{let e=d(c,e=>{e&&m()});return()=>e()},[]);let m=async()=>{try{n(!0);let e=await o.getAll();t(e),r(null)}catch(e){r("Failed to load delivery rules"),console.error(e)}finally{n(!1)}};return(0,a.jsx)(D.Z,{children:(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 py-8",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,a.jsx)("div",{className:"md:flex md:items-center md:justify-between",children:(0,a.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold leading-7 text-gray-900 sm:truncate sm:text-3xl sm:tracking-tight",children:"Delivery Rules"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Configure rules to determine how notifications are delivered"})]})}),l&&(0,a.jsx)("div",{className:"mt-4 rounded-md bg-red-50 p-4",children:(0,a.jsx)("div",{className:"flex",children:(0,a.jsx)("div",{className:"ml-3",children:(0,a.jsx)("h3",{className:"text-sm font-medium text-red-800",children:l})})})}),s?(0,a.jsx)("div",{className:"mt-4 text-center",children:(0,a.jsx)("div",{className:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-current border-r-transparent align-[-0.125em] motion-reduce:animate-[spin_1.5s_linear_infinite]"})}):(0,a.jsx)(Z,{rules:e,onUpdate:m})]})})})}},5507:function(e,t,s){"use strict";var a=s(3827),i=s(4090),n=s(4849),l=s(129),r=s(6170),c=s(7474),d=s(4424),o=s(1310),m=s(8621),x=s(9631);function u(e){let{channel:t,onRemove:s,onClick:n,className:l="",isButton:r=!1}=e,o=function(e){let t="";if(e.description&&(t=e.description),"TIME_BASED"===e.type&&e.slots&&e.slots.length>0){let s=e.slots.length;t?t+=" (".concat(s," time slot").concat(s>1?"s":"",")"):t="".concat(s," time slot").concat(s>1?"s":"")}return t||"No description"}(t),m=x.Cc[t.type],[u,h]=(0,i.useState)(!1),g=r?"text-sm text-gray-500":"text-xs text-gray-500";return(0,a.jsxs)(r?"button":"div",{onClick:n,className:"flex items-start space-x-3 bg-white rounded-lg border border-gray-200 ".concat(r?"w-full text-left hover:bg-gray-50":""," ").concat(r?"p-4 hover:bg-gray-50":"p-2"," ").concat(l),...r?{type:"button"}:{},children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)(m,{className:"".concat(r?"h-6 w-6":"h-5 w-5"," text-gray-400"),"aria-hidden":"true"})}),(0,a.jsx)("div",{className:"min-w-0 flex-1",children:(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsxs)("div",{className:"flex items-baseline",children:[(0,a.jsx)("span",{className:"".concat(r?"text-base":"text-sm"," font-medium text-gray-900"),children:t.name}),(0,a.jsxs)("span",{className:"".concat(g," ml-1"),children:["(",(0,x.o4)(t.type),")"]})]}),o?(0,a.jsxs)("div",{className:"relative mt-0.5",onMouseEnter:()=>h(!0),onMouseLeave:()=>h(!1),children:[(0,a.jsx)("p",{className:"".concat(g," truncate max-w-[300px]"),children:o}),u&&o.length>50&&(0,a.jsx)("div",{className:"absolute z-10 px-2 py-1 text-sm text-white bg-gray-900 rounded shadow-lg -mt-1 transform -translate-y-full max-w-xs",children:o})]}):(0,a.jsxs)("div",{className:"flex items-center mt-0.5 text-gray-400",children:[(0,a.jsx)(c.Z,{className:"h-4 w-4 mr-1"}),(0,a.jsx)("span",{className:"".concat(g," italic"),children:"No description available"})]})]})}),s&&(0,a.jsx)("button",{type:"button",onClick:e=>{e.stopPropagation(),s()},className:"flex-shrink-0 p-1 text-gray-400 hover:text-gray-500",children:(0,a.jsx)(d.Z,{className:"h-4 w-4"})})]})}let h=(0,i.forwardRef)(function(e,t){let{value:s=[],onChange:d,className:x="",hideAddButton:h=!1}=e,[g,v]=(0,i.useState)(!1),[p,y]=(0,i.useState)([]),[f,j]=(0,i.useState)(null);(0,i.useImperativeHandle)(t,()=>({openDialog:()=>v(!0)}),[]),(0,i.useEffect)(()=>{(async function(){try{let e=await n.q.getAll();y(e)}catch(e){console.error("Failed to fetch channels:",e),j("Failed to load channels")}})()},[]);let b=e=>{let t=parseInt(e,10),a=p.find(e=>e.id===t);a&&!s.some(e=>e.id===t)&&d([...s,a]),v(!1)},N=e=>{let t=parseInt(e,10);d(s.filter(e=>e.id!==t))},w=p.filter(e=>!s.some(t=>t.id===e.id));return(0,a.jsxs)("div",{className:x,children:[(0,a.jsx)("div",{className:"space-y-2",children:0===s.length?(0,a.jsx)("div",{className:"rounded-lg border border-dashed border-gray-300 p-4",children:(0,a.jsx)("p",{className:"text-sm text-gray-500 text-center text-italic",children:"No delivery channel is selected"})}):s.map(e=>(0,a.jsx)(u,{channel:e,onRemove:()=>N(e.id.toString())},e.id))}),!h&&(0,a.jsxs)("button",{type:"button",onClick:()=>v(!0),className:"mt-2 inline-flex items-center text-sm text-indigo-600 hover:text-indigo-500",children:[(0,a.jsx)(o.Z,{className:"h-4 w-4 mr-1"}),"Add Channel"]}),(0,a.jsx)(l.u.Root,{show:g,as:i.Fragment,children:(0,a.jsxs)(r.V,{as:"div",className:"relative z-50",onClose:v,children:[(0,a.jsx)(l.u.Child,{as:i.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:(0,a.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"})}),(0,a.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,a.jsx)("div",{className:"flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0",children:(0,a.jsx)(l.u.Child,{as:i.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",enterTo:"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 translate-y-0 sm:scale-100",leaveTo:"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95",children:(0,a.jsxs)(r.V.Panel,{className:"relative transform overflow-hidden rounded-lg bg-white px-4 pb-4 pt-5 text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg sm:p-6",children:[(0,a.jsx)("div",{className:"absolute right-0 top-0 hidden pr-4 pt-4 sm:block",children:(0,a.jsxs)("button",{type:"button",className:"rounded-md bg-white text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",onClick:()=>v(!1),children:[(0,a.jsx)("span",{className:"sr-only",children:"Close"}),(0,a.jsx)(m.Z,{className:"h-6 w-6","aria-hidden":"true"})]})}),(0,a.jsx)("div",{children:(0,a.jsxs)("div",{className:"mt-3 sm:mt-5",children:[(0,a.jsx)(r.V.Title,{as:"h3",className:"text-base font-semibold leading-6 text-gray-900",children:"Add Channel"}),(0,a.jsx)("div",{className:"mt-4",children:f?(0,a.jsx)("div",{className:"rounded-md bg-red-50 p-4",children:(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)(c.Z,{className:"h-5 w-5 text-red-400","aria-hidden":"true"})}),(0,a.jsx)("div",{className:"ml-3",children:(0,a.jsx)("h3",{className:"text-sm font-medium text-red-800",children:f})})]})}):0===w.length?(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"No available channels to add."}):(0,a.jsx)("div",{className:"space-y-2",children:w.map(e=>(0,a.jsx)(u,{channel:e,onClick:()=>b(e.id.toString()),isButton:!0},e.id))})})]})})]})})})})]})})]})});h.displayName="DeliveryChannelSelector",t.Z=h}},function(e){e.O(0,[9321,8593,3107,4661,542,9509,9128,9359,8269,416,7678,9631,2971,8069,1744],function(){return e(e.s=6784)}),_N_E=e.O()}]);